---
phase: 13-module-4-content
plan: 04
type: execute
wave: 3
depends_on: ["13-02", "13-03"]
files_modified: [src/lib/content/module4/python-segmentation-clv.ts, src/lib/content/module4/index.ts, src/lib/data/modules.ts, src/lib/glossary/concepts/module4.ts, src/lib/glossary/index.ts, src/lib/exam/questions/module4.ts, src/lib/exam/index.ts]
autonomous: false
---

<objective>
Create Lecture 8 (Python Demo: Segmentation + CLV), comprehensive glossary (~40 terms), and exam questions (~50 questions) for Module 4. Verify all 8 lectures render correctly.

Purpose: Complete Module 4 with the practical Python demonstration, full glossary of concepts, and exam preparation materials. Final checkpoint ensures everything works.

Output: Complete Module 4 with all 8 lectures, 40+ glossary terms, 50 exam questions, verified rendering.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-module-4-content/13-01-SUMMARY.md
@.planning/phases/13-module-4-content/13-02-SUMMARY.md
@.planning/phases/13-module-4-content/13-03-SUMMARY.md

@src/lib/data/modules.ts
@src/lib/content/types.ts
@src/lib/content/module4/index.ts
@src/lib/glossary/concepts/module3.ts
@src/lib/glossary/index.ts
@src/lib/exam/questions/module3.ts
@src/lib/exam/index.ts

Source material (Module 4 notes — lecture 8):
@/Users/boris/Documents/KnowledgeDB/UIUC-iMBA/2026-Spring\ -\ Applying\ Data\ Analytics\ in\ Marketing\ -\ MBA\ 564A/Module\ 4\ -\ Customer\ Preferences\ and\ Lifetime\ Value\ Analysis.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Lecture 8 — Python Demo: Segmentation and CLV</name>
  <files>src/lib/content/module4/python-segmentation-clv.ts, src/lib/content/module4/index.ts, src/lib/data/modules.ts</files>
  <action>
  Transform Lecture 8 source notes into rich visual content. This is the practical demonstration tying together segmentation and CLV calculation using Python.

  Create 7 content sections:

  1. **Text section: "Python Analytics Pipeline"** — Overview of the demo: combines customer segmentation (K-means clustering) with CLV calculation. Libraries: pandas (tables), NumPy (numerics), matplotlib/seaborn (viz), sklearn (ML). Dataset: smartwatch adoption with behavioral and health metrics (~120K rows, ~40 variables, sampled to 20%).

  2. **Explanation section: "Data Preparation Pipeline"** — 4-step animated explanation:
     - Step 1: "Load & Explore" — pd.read_csv(), df.head(), df.describe(). Check structure, variables, observations. Identify target variable (adoption) and features.
     - Step 2: "Feature Scaling" — K-means is sensitive to variable scale. Large values "pull" cluster centers. StandardScaler: transform to mean=0, std=1. Makes feature contributions comparable.
     - Step 3: "Random Sampling" — Take 20% random subsample for faster computation. Full dataset not needed for demonstration. Maintains statistical properties.
     - Step 4: "Ready for Analysis" — Scaled, sampled data ready for clustering and CLV computation.

  3. **Diagram section: "K-means Clustering Process"** — Visualization of clustering:
     - Node: "Raw Data" (type: variable) → Edge "StandardScaler" → Node: "Scaled Data" (type: treatment)
     - Node: "Scaled Data" → Edge "KMeans(k=N)" → Node: "Clusters" (type: outcome)
     - Side nodes for "Elbow Method" and "Silhouette Score" pointing to cluster quality assessment
     - Label: "Choose optimal k, then interpret clusters as business segments"

  4. **Text section: "Choosing the Number of Clusters"** — Two methods:
     (1) **Elbow Method** — Plot k vs within-cluster sum of squares. Look for the "elbow" where adding more clusters gives diminishing returns.
     (2) **Silhouette Score** — Measures cluster separation: close to 1 = well separated, near 0 = overlapping, negative = poor clustering. In the demo: silhouette ≈ 0.19 (moderate separation — real-world data is messy).
     PCA used for 2D visualization only (not for clustering itself). Multi-dimensional data → 2 components → plot.

  5. **Text section: "Interpreting Clusters as Business Segments"** — After clustering, compare clusters by: age, BMI, recency, gender, health behavior. Example findings: Cluster 1 = younger customers, Cluster 0 = higher recency. Abstract clusters become actionable business segments. Can validate with statistical tests.

  6. **Explanation section: "CLV Calculation in Python"** — 3-step explanation:
     - Step 1: "Basic CLV" — Formula: CLV = purchase_value × purchase_frequency × lifespan. Lifespan set to 3 years. Calculated per customer row. Average CLV ≈ 300,000. BUT this is wrong — no discounting!
     - Step 2: "Discounted CLV" — Apply discount rate (20%). CLV drops to ≈ 221,000. This is the financially correct value. Always use discounted CLV.
     - Step 3: "Segment-Level CLV" — Calculate average CLV per cluster. Identify which segments are most valuable. Cluster + CLV = segment-level customer economics. Enables personalized marketing, pricing, and budget allocation.

  7. **Text section: "Practical Applications"** — Results enable: personalized marketing by segment, pricing optimization per cluster, budget reallocation to high-CLV segments, connecting segmentation to financial value. The pipeline: Load → Scale → Cluster → Visualize → Calculate CLV → Decide.

  Update module4/index.ts to export lecture 8.
  Update modules.ts to set lecture 8 status to 'ready'.
  </action>
  <verify>npm run build passes, lecture renders at /module/customer-preferences-clv/python-segmentation-clv</verify>
  <done>Lecture 8 renders with all 7 sections, pipeline animations work, clustering process diagram displays</done>
</task>

<task type="auto">
  <name>Task 2: Create glossary terms and exam questions for Module 4</name>
  <files>src/lib/glossary/concepts/module4.ts, src/lib/glossary/index.ts, src/lib/exam/questions/module4.ts, src/lib/exam/index.ts</files>
  <action>
  **Glossary — Create ~40 concepts across all 8 lectures:**

  Follow the exact pattern from module3.ts. Each concept needs: id (kebab-case), term, definition (1-2 sentences), extendedDefinition (longer markdown explanation), category, relatedConcepts (array of ids), lectureId (1-8), moduleId ('4'), tags (array).

  Categories to use: 'foundation', 'method', 'estimator', 'bias', 'design'

  Distribution across lectures (approximate):
  - L1 (5 terms): Market Segmentation, Target Market, Positioning, Conjoint Analysis, Customer Lifetime Value
  - L2 (7 terms): STP Framework, Demographic Segmentation, Psychographic Segmentation, Behavioral Segmentation, K-means Clustering, Vertical Attributes, Horizontal Attributes, Market Mapping, Principal Component Analysis
  - L3 (6 terms): Conjoint Analysis (detailed), Product Profile, Part-worth Utility, Trade-off, Attribute Importance, Pretest
  - L4 (6 terms): Customer Acquisition Cost, Contribution Margin, Retention Rate, Discount Rate, Time Value of Money, Payback Period, Metric Misalignment, Discounted CLV, Undiscounted CLV
  - L5 (4 terms): Planning Horizon, Retention Probability, Cumulative CLV, CLV Formula
  - L6 (5 terms): AI Generated Content, Large Language Models, Next Token Prediction, Personal Voice, Content Homogenization
  - L7 (6 terms): Customer Churn, Churn Propensity Score, Outcome-Based Targeting, Incrementality-Based Targeting, Retention Sensitivity, Uplift Modeling
  - L8 (4 terms): Feature Scaling, Standardization, Silhouette Score, Elbow Method

  Add meaningful cross-references between related concepts (e.g., Retention Rate ↔ Customer Churn, Conjoint Analysis ↔ Part-worth Utility).

  Update glossary/index.ts: import module4Concepts, add to allConcepts array. Follow the exact pattern used for module3.

  **Exam Questions — Create 50 questions distributed across all 8 lectures:**

  Follow the exact pattern from module3.ts. Each question needs: id (format 'm4-lN-dN'), question, answer (with explanation), difficulty ('easy'|'medium'|'hard'), lectureId (1-8).

  Distribution: ~10 easy (20%), ~27 medium (54%), ~13 hard (26%).
  Spread across lectures: approximately 6-7 questions per lecture.

  Question types to include:
  - Definition questions (easy): "What is X?" → definition
  - Application questions (medium): "Why does X lead to Y?" → analysis
  - Analytical questions (hard): "Compare X and Y approaches. When would you use each?" → synthesis

  Cover ALL key concepts: STP, K-means, conjoint analysis, part-worth utility, CLV formula components, discounting, retention effects, AGC engagement paradox, churn vs incrementality, uplift modeling, feature scaling, silhouette score.

  Update exam/index.ts: import module4Questions, add to allQuestions array, update getQuestionsByModule. Follow exact pattern from module3.
  </action>
  <verify>npm run build passes, glossary page shows Module 4 concepts, exam page shows Module 4 questions</verify>
  <done>~40 glossary terms created with cross-references, 50 exam questions with proper difficulty distribution, both integrated into app</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Module 4: Customer Preferences and Lifetime Value Analysis with 8 lectures, 40+ glossary terms, and 50 exam questions. All content features visual diagrams, animated step-by-step explanations, and interactive elements.</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Navigate to Module 4 in the sidebar
    3. Verify all 8 lectures are listed and accessible:
       - L1: Consumer Demand and Preferences — case study animation, module roadmap
       - L2: STP Framework — segmentation types animation, market map, K-means diagram
       - L3: Conjoint Analysis — how conjoint works animation, part-worth utility chart
       - L4: CLV Introduction — why CLV matters animation, components diagram
       - L5: CLV Calculation — step-by-step calculation animation, decay curve
       - L6: AGC and Engagement — LLM explanation, AI vs human content comparison
       - L7: Churn and Incrementality — traditional vs incrementality animation, 2×2 matrix
       - L8: Python Demo — data pipeline animation, clustering diagram, CLV calculation
    4. Test animated explanations in at least 3 lectures — steps should progress
    5. Check glossary page — Module 4 terms should appear
    6. Check exam page — Module 4 questions should appear with difficulty filtering
    7. Verify mobile layout is acceptable (resize browser)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] All 8 lectures render correctly
- [ ] All animated explanations work
- [ ] All diagrams display properly
- [ ] ~40 glossary terms visible on glossary page
- [ ] 50 exam questions visible on exam page
- [ ] Module 4 is fully navigable
- [ ] User has verified visual correctness
</verification>

<success_criteria>

- All 8 Module 4 lectures complete and rendering
- ~40 glossary concepts with cross-references
- 50 exam questions with proper difficulty distribution
- All visual elements (diagrams, animations) working
- User has approved visual verification
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/13-module-4-content/13-04-SUMMARY.md`
</output>
